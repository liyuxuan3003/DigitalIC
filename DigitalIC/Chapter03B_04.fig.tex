\documentclass{xStandalone}

\begin{document}
\begin{tikzpicture}

\xValDefine{xL}[-3.0]
\xValDefine{xR}[+3.0]

\xValProportion{xGL}{xL}{xR}[1/3]
\xValProportion{xGR}{xL}{xR}[2/3]
\xValOffset{xSL}{xL}
\xValOffset{xSR}{xGL}
\xValOffset{xDL}{xGR}
\xValOffset{xDR}{xR}

\xValMiddle{xS}{xSL}{xSR}
\xValMiddle{xG}{xGL}{xGR}
\xValMiddle{xD}{xDL}{xDR}

\xValOffset{xSdpr}{xSR}[+0.2]
\xValOffset{xDdpr}{xDL}[-0.2]

\xValDefine{yB}[0.0]
\xValDefine{yA}[2.0]
\xValOffset{yPin}{yA}[1.0]
\xValOffset{ySiO2}{yA}[0.5]
\xValProportion{yDope}{yA}{yB}[0.4]

\xValOffset{ydpr}{yDope}[-0.2]

\xGeneratePoints{xL,xR,xGL,xGR,xSL,xSR,xDL,xDR,xS,xD,xG,xSdpr,xDdpr}{yB,yA,yPin,ySiO2,yDope,ydpr}

\draw[fill=mnmP2] (xL/yB) rectangle node[below,white] {$p$}  (xR/yA);

\draw[fill=mnmN0] (xSL/yDope) rectangle node[white] {$n^{+}$} (xSR/yA);
\draw[fill=mnmN0] (xDL/yDope) rectangle node[white] {$n^{+}$} (xDR/yA);

\draw[fill=mnmSiO2] (xGL/yA) rectangle node[black] {\ce{SiO2}} (xGR/ySiO2);

\draw (xS/yA) -- (xS/yPin) node[ocirc] {} node[above] {S};
\draw (xD/yA) -- (xD/yPin) node[ocirc] {} node[above] {D};
\draw (xG/ySiO2) -- (xG/yPin) node[ocirc] {} node[above] {G};

\draw[fill=mnmDepletion] (xSL/ydpr) -- (xSdpr/ydpr) -- (xSdpr/yA) -- (xSR/yA) -- (xSR/yDope) -- (xSL/yDope) -- cycle;
\draw[fill=mnmDepletion] (xDR/ydpr) -- (xDdpr/ydpr) -- (xDdpr/yA) -- (xDL/yA) -- (xDL/yDope) -- (xDR/yDope) -- cycle;

\end{tikzpicture}
\end{document}